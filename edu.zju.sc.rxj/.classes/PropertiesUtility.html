


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="htmlId">
<head>
  <title>Coverage Report :: PropertiesUtility</title>
  <style type="text/css">
    @import "../../.css/coverage.css";
  </style>
</head>

<body>
<div class="header"></div>

<div class="content">
<div class="breadCrumbs">
    [ <a href="../../index.html">all classes</a> ]
    [ <a href="../index.html">edu.zju.sc.rxj</a> ]
</div>

<h1>Coverage Summary for Class: PropertiesUtility (edu.zju.sc.rxj)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">PropertiesUtility</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/ 1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    90%
  </span>
  <span class="absValue">
    (9/ 10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    97.3%
  </span>
  <span class="absValue">
    (73/ 75)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<div class="sourceCode"><i>1</i>&nbsp;package edu.zju.sc.rxj;
<i>2</i>&nbsp;
<i>3</i>&nbsp;import java.lang.*;
<i>4</i>&nbsp;import java.text.NumberFormat;
<i>5</i>&nbsp;import java.text.ParseException;
<i>6</i>&nbsp;import java.text.ParsePosition;
<i>7</i>&nbsp;import java.text.SimpleDateFormat;
<i>8</i>&nbsp;import java.util.*;
<i>9</i>&nbsp;
<i>10</i>&nbsp;/**
<i>11</i>&nbsp; * This is a utility class that provides static methods for retrieving properties of different types (String, Integer, Long, Double, Date, Class) from Properties instance. This utility throws en exception specified by the caller if required property is missing or cannot be parsed properly. getSubConfiguration() method allows to extract inner configuration from Properties instance (when &quot;childConfigName.childPropertyName&quot; format is used for property keys).
<i>12</i>&nbsp; * &lt;p&gt;
<i>13</i>&nbsp; * Thread Safety:
<i>14</i>&nbsp; * This class is immutable and thread safe when properties parameters passed to it are used by the caller in thread safe manner.
<i>15</i>&nbsp; */
<i>16</i>&nbsp;public class PropertiesUtility {
<i>17</i>&nbsp;
<b class="nc"><i>18</i>&nbsp;    private PropertiesUtility() {</b>
<b class="nc"><i>19</i>&nbsp;    }</b>
<i>20</i>&nbsp;
<i>21</i>&nbsp;    /**
<i>22</i>&nbsp;     * Retrieves the string property from the given Properties instance.
<i>23</i>&nbsp;     * &lt;p&gt;
<i>24</i>&nbsp;     * Generic Parameters:
<i>25</i>&nbsp;     * T - the type of the exception to be thrown if some error occurred
<i>26</i>&nbsp;     * &lt;p&gt;
<i>27</i>&nbsp;     * Parameters:
<i>28</i>&nbsp;     * properties - the properties container
<i>29</i>&nbsp;     * key - the key of the property to be retrieved
<i>30</i>&nbsp;     * required - true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>31</i>&nbsp;     * exceptionClass - the type of the exception to be thrown if some error occurs
<i>32</i>&nbsp;     * &lt;p&gt;
<i>33</i>&nbsp;     * Returns:
<i>34</i>&nbsp;     * the retrieved string property value (null if property is optional and missing)
<i>35</i>&nbsp;     * &lt;p&gt;
<i>36</i>&nbsp;     * Throws:
<i>37</i>&nbsp;     * T if the property is required, but missing
<i>38</i>&nbsp;     * &lt;p&gt;
<i>39</i>&nbsp;     * Implementation Notes:
<i>40</i>&nbsp;     * 1. String value = properties.getProperty(key);
<i>41</i>&nbsp;     * 2. If value == null then
<i>42</i>&nbsp;     * 2.1. If required then
<i>43</i>&nbsp;     * 2.1.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);
<i>44</i>&nbsp;     * 2.2. Return null.
<i>45</i>&nbsp;     * 3. Return value.
<i>46</i>&nbsp;     *
<i>47</i>&nbsp;     * @param exceptionClass the type of the exception to be thrown if some error occurs
<i>48</i>&nbsp;     * @param properties     the properties container
<i>49</i>&nbsp;     * @param key            the key of the property to be retrieved
<i>50</i>&nbsp;     * @param required       true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>51</i>&nbsp;     * @return the retrieved string property value (null if property is optional and missing)
<i>52</i>&nbsp;     * @throws T if the property is required, but missing
<i>53</i>&nbsp;     */
<i>54</i>&nbsp;    public static &lt;T extends Throwable&gt; String getStringProperty(Properties properties, String key, boolean required, Class&lt;T&gt; exceptionClass) throws Exception, Throwable {
<b class="fc"><i>55</i>&nbsp;        String value = (String)properties.getProperty(key);</b>
<b class="fc"><i>56</i>&nbsp;        if (value == null) {</b>
<b class="fc"><i>57</i>&nbsp;            if (required) {</b>
<b class="fc"><i>58</i>&nbsp;                throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);</b>
<i>59</i>&nbsp;            }
<b class="fc"><i>60</i>&nbsp;            return null;</b>
<i>61</i>&nbsp;        }
<b class="fc"><i>62</i>&nbsp;        return value;</b>
<i>63</i>&nbsp;    }
<i>64</i>&nbsp;
<i>65</i>&nbsp;    /**
<i>66</i>&nbsp;     * Retrieves the delimited(分割之后的) strings property from the given Properties instance.
<i>67</i>&nbsp;     * &lt;p&gt;
<i>68</i>&nbsp;     * Generic Parameters:
<i>69</i>&nbsp;     * T - the type of the exception to be thrown if some error occurred
<i>70</i>&nbsp;     * &lt;p&gt;
<i>71</i>&nbsp;     * Parameters:
<i>72</i>&nbsp;     * properties - the properties container
<i>73</i>&nbsp;     * key - the key of the property to be retrieved
<i>74</i>&nbsp;     * delimiter - the delimiter regular expression pattern
<i>75</i>&nbsp;     * required - true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>76</i>&nbsp;     * exceptionClass - the type of the exception to be thrown if some error occurs
<i>77</i>&nbsp;     * &lt;p&gt;
<i>78</i>&nbsp;     * Returns:
<i>79</i>&nbsp;     * the retrieved strings values (null if property is optional and missing)
<i>80</i>&nbsp;     * &lt;p&gt;
<i>81</i>&nbsp;     * Throws:
<i>82</i>&nbsp;     * T if the property is required, but missing
<i>83</i>&nbsp;     * &lt;p&gt;
<i>84</i>&nbsp;     * Implementation Notes:
<i>85</i>&nbsp;     * 1. String value = properties.getProperty(key);
<i>86</i>&nbsp;     * 2. If value == null then
<i>87</i>&nbsp;     * 2.1. If required then
<i>88</i>&nbsp;     * 2.1.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);
<i>89</i>&nbsp;     * 2.2. Return null.
<i>90</i>&nbsp;     * 3. Return value.split(delimiter, -1).
<i>91</i>&nbsp;     *
<i>92</i>&nbsp;     * @param delimiter      the delimiter regular expression pattern
<i>93</i>&nbsp;     * @param exceptionClass the type of the exception to be thrown if some error occurs
<i>94</i>&nbsp;     * @param properties     the properties container
<i>95</i>&nbsp;     * @param key            the key of the property to be retrieved
<i>96</i>&nbsp;     * @param required       true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>97</i>&nbsp;     * @return the retrieved strings values (null if property is optional and missing)
<i>98</i>&nbsp;     * @throws T if the property is required, but missing
<i>99</i>&nbsp;     */
<i>100</i>&nbsp;    public static &lt;T extends Throwable&gt; String[] getStringsProperty(Properties properties, String key, String delimiter, boolean required, Class&lt;T&gt; exceptionClass) throws Exception, Throwable {
<b class="fc"><i>101</i>&nbsp;        String value = properties.getProperty(key);</b>
<b class="fc"><i>102</i>&nbsp;        if (value == null) {</b>
<b class="fc"><i>103</i>&nbsp;            if (required) {</b>
<b class="fc"><i>104</i>&nbsp;                throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);</b>
<i>105</i>&nbsp;            }
<b class="fc"><i>106</i>&nbsp;            return null;</b>
<i>107</i>&nbsp;        }
<b class="fc"><i>108</i>&nbsp;        return value.split(delimiter, -1);</b>
<i>109</i>&nbsp;    }
<i>110</i>&nbsp;
<i>111</i>&nbsp;    /**
<i>112</i>&nbsp;     * Retrieves the integer property from the given Properties instance.
<i>113</i>&nbsp;     * &lt;p&gt;
<i>114</i>&nbsp;     * Generic Parameters:
<i>115</i>&nbsp;     * T - the type of the exception to be thrown if some error occurred
<i>116</i>&nbsp;     * &lt;p&gt;
<i>117</i>&nbsp;     * Parameters:
<i>118</i>&nbsp;     * properties - the properties container
<i>119</i>&nbsp;     * key - the key of the property to be retrieved
<i>120</i>&nbsp;     * required - true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>121</i>&nbsp;     * exceptionClass - the type of the exception to be thrown if some error occurs
<i>122</i>&nbsp;     * &lt;p&gt;
<i>123</i>&nbsp;     * Returns:
<i>124</i>&nbsp;     * the retrieved integer property value (null if property is optional and missing)
<i>125</i>&nbsp;     * &lt;p&gt;
<i>126</i>&nbsp;     * Throws:
<i>127</i>&nbsp;     * T if the property value has invalid format or is required, but missing
<i>128</i>&nbsp;     * &lt;p&gt;
<i>129</i>&nbsp;     * Implementation Notes:
<i>130</i>&nbsp;     * 1. String value = properties.getProperty(key);
<i>131</i>&nbsp;     * 2. If value == null then
<i>132</i>&nbsp;     * 2.1. If required then
<i>133</i>&nbsp;     * 2.1.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);
<i>134</i>&nbsp;     * 2.2. Return null.
<i>135</i>&nbsp;     * 3. Integer result = Integer.valueOf(value);
<i>136</i>&nbsp;     * 4. If ex:NumberFormatException is thrown then
<i>137</i>&nbsp;     * 4.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be a valid integer&quot;, ex);
<i>138</i>&nbsp;     * 5. Return result.
<i>139</i>&nbsp;     *
<i>140</i>&nbsp;     * @param exceptionClass the type of the exception to be thrown if some error occurs
<i>141</i>&nbsp;     * @param properties     the properties container
<i>142</i>&nbsp;     * @param key            the key of the property to be retrieved
<i>143</i>&nbsp;     * @param required       true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>144</i>&nbsp;     * @return the retrieved integer property value (null if property is optional and missing)
<i>145</i>&nbsp;     * @throws T if the property value has invalid format or is required, but missing
<i>146</i>&nbsp;     */
<i>147</i>&nbsp;    public static &lt;T extends Throwable&gt; Integer getIntegerProperty(Properties properties, String key, boolean required, Class&lt;T&gt; exceptionClass) throws Exception, Throwable {
<b class="fc"><i>148</i>&nbsp;        String value = properties.getProperty(key);</b>
<b class="fc"><i>149</i>&nbsp;        if (value == null) {</b>
<b class="fc"><i>150</i>&nbsp;            if (required) {</b>
<b class="fc"><i>151</i>&nbsp;                throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);</b>
<i>152</i>&nbsp;            } else {
<b class="fc"><i>153</i>&nbsp;                return null;</b>
<i>154</i>&nbsp;            }
<i>155</i>&nbsp;        }
<i>156</i>&nbsp;        Integer result;
<i>157</i>&nbsp;        try {
<b class="fc"><i>158</i>&nbsp;            result = Integer.valueOf(value);</b>
<i>159</i>&nbsp;
<b class="fc"><i>160</i>&nbsp;        } catch (NumberFormatException ex) {</b>
<b class="fc"><i>161</i>&nbsp;            throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be a valid  integer&quot;, ex);</b>
<b class="fc"><i>162</i>&nbsp;        }</b>
<i>163</i>&nbsp;
<b class="fc"><i>164</i>&nbsp;        return result;</b>
<i>165</i>&nbsp;    }
<i>166</i>&nbsp;
<i>167</i>&nbsp;    /**
<i>168</i>&nbsp;     * Retrieves the long integer property from the given Properties instance.
<i>169</i>&nbsp;     * &lt;p&gt;
<i>170</i>&nbsp;     * Generic Parameters:
<i>171</i>&nbsp;     * T - the type of the exception to be thrown if some error occurred
<i>172</i>&nbsp;     * &lt;p&gt;
<i>173</i>&nbsp;     * Parameters:
<i>174</i>&nbsp;     * properties - the properties container
<i>175</i>&nbsp;     * key - the key of the property to be retrieved
<i>176</i>&nbsp;     * required - true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>177</i>&nbsp;     * exceptionClass - the type of the exception to be thrown if some error occurs
<i>178</i>&nbsp;     * &lt;p&gt;
<i>179</i>&nbsp;     * Returns:
<i>180</i>&nbsp;     * the retrieved long integer property value (null if property is optional and missing)
<i>181</i>&nbsp;     * &lt;p&gt;
<i>182</i>&nbsp;     * Throws:
<i>183</i>&nbsp;     * T if the property value has invalid format or is required, but missing
<i>184</i>&nbsp;     * &lt;p&gt;
<i>185</i>&nbsp;     * Implementation Notes:
<i>186</i>&nbsp;     * 1. String value = properties.getProperty(key);
<i>187</i>&nbsp;     * 2. If value == null then
<i>188</i>&nbsp;     * 2.1. If required then
<i>189</i>&nbsp;     * 2.1.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);
<i>190</i>&nbsp;     * 2.2. Return null.
<i>191</i>&nbsp;     * 3. Long result = Long.valueOf(value);
<i>192</i>&nbsp;     * 4. If ex:NumberFormatException is thrown then
<i>193</i>&nbsp;     * 4.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be a valid long integer&quot;, ex);
<i>194</i>&nbsp;     * 5. Return result.
<i>195</i>&nbsp;     *
<i>196</i>&nbsp;     * @param exceptionClass the type of the exception to be thrown if some error occurs
<i>197</i>&nbsp;     * @param properties     the properties container
<i>198</i>&nbsp;     * @param key            the key of the property to be retrieved
<i>199</i>&nbsp;     * @param required       true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>200</i>&nbsp;     * @return the retrieved long integer property value (null if property is optional and missing)
<i>201</i>&nbsp;     * @throws T if the property value has invalid format or is required, but missing
<i>202</i>&nbsp;     */
<i>203</i>&nbsp;    public static &lt;T extends Throwable&gt; Long getLongProperty(Properties properties, String key, boolean required, Class&lt;T&gt; exceptionClass) throws Exception, Throwable {
<b class="fc"><i>204</i>&nbsp;        String value = properties.getProperty(key);</b>
<b class="fc"><i>205</i>&nbsp;        if (value == null) {</b>
<b class="fc"><i>206</i>&nbsp;            if (required) {</b>
<b class="fc"><i>207</i>&nbsp;                throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);</b>
<i>208</i>&nbsp;            } else {
<b class="fc"><i>209</i>&nbsp;                return null;</b>
<i>210</i>&nbsp;            }
<i>211</i>&nbsp;        }
<i>212</i>&nbsp;        Long result;
<i>213</i>&nbsp;        try {
<b class="fc"><i>214</i>&nbsp;            result = Long.valueOf(value);</b>
<i>215</i>&nbsp;
<b class="fc"><i>216</i>&nbsp;        } catch (NumberFormatException ex) {</b>
<b class="fc"><i>217</i>&nbsp;            throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be a valid long integer&quot;, ex);</b>
<b class="fc"><i>218</i>&nbsp;        }</b>
<i>219</i>&nbsp;
<b class="fc"><i>220</i>&nbsp;        return result;</b>
<i>221</i>&nbsp;    }
<i>222</i>&nbsp;
<i>223</i>&nbsp;    /**
<i>224</i>&nbsp;     * Retrieves the double property from the given Properties instance.
<i>225</i>&nbsp;     * &lt;p&gt;
<i>226</i>&nbsp;     * Generic Parameters:
<i>227</i>&nbsp;     * T - the type of the exception to be thrown if some error occurred
<i>228</i>&nbsp;     * &lt;p&gt;
<i>229</i>&nbsp;     * Parameters:
<i>230</i>&nbsp;     * properties - the properties container
<i>231</i>&nbsp;     * key - the key of the property to be retrieved
<i>232</i>&nbsp;     * required - true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>233</i>&nbsp;     * exceptionClass - the type of the exception to be thrown if some error occurs
<i>234</i>&nbsp;     * &lt;p&gt;
<i>235</i>&nbsp;     * Returns:
<i>236</i>&nbsp;     * the retrieved double property value (null if property is optional and missing)
<i>237</i>&nbsp;     * &lt;p&gt;
<i>238</i>&nbsp;     * Throws:
<i>239</i>&nbsp;     * T if the property value has invalid format or is required, but missing
<i>240</i>&nbsp;     * &lt;p&gt;
<i>241</i>&nbsp;     * Implementation Notes:
<i>242</i>&nbsp;     * 1. String value = properties.getProperty(key);
<i>243</i>&nbsp;     * 2. If value == null then
<i>244</i>&nbsp;     * 2.1. If required then
<i>245</i>&nbsp;     * 2.1.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);
<i>246</i>&nbsp;     * 2.2. Return null.
<i>247</i>&nbsp;     * 3. parsePosition = new ParsePosition(0);
<i>248</i>&nbsp;     * 4. Double result = NumberFormat.getInstance(Locale.US).parse(value, parsePosition);
<i>249</i>&nbsp;     * 5. If ex:ParseException is thrown then
<i>250</i>&nbsp;     * 5.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be a valid double&quot;, ex);
<i>251</i>&nbsp;     * 6. If parsePosition.getIndex() != value.length() then
<i>252</i>&nbsp;     * 6.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be a valid double&quot;);
<i>253</i>&nbsp;     * 7. Return result.
<i>254</i>&nbsp;     *
<i>255</i>&nbsp;     * @param exceptionClass the type of the exception to be thrown if some error occurs
<i>256</i>&nbsp;     * @param properties     the properties container
<i>257</i>&nbsp;     * @param key            the key of the property to be retrieved
<i>258</i>&nbsp;     * @param required       true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>259</i>&nbsp;     * @return the retrieved double property value (null if property is optional and missing)
<i>260</i>&nbsp;     * @throws T if the property value has invalid format or is required, but missing
<i>261</i>&nbsp;     */
<i>262</i>&nbsp;    public static &lt;T extends Throwable&gt; Double getDoubleProperty(Properties properties, String key, boolean required, Class&lt;T&gt; exceptionClass) throws Exception, Throwable {
<b class="fc"><i>263</i>&nbsp;        String value = properties.getProperty(key);</b>
<b class="fc"><i>264</i>&nbsp;        if (value == null) {</b>
<b class="fc"><i>265</i>&nbsp;            if (required) {</b>
<b class="fc"><i>266</i>&nbsp;                throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);</b>
<i>267</i>&nbsp;            } else {
<b class="fc"><i>268</i>&nbsp;                return null;</b>
<i>269</i>&nbsp;            }
<i>270</i>&nbsp;        }
<i>271</i>&nbsp;        Double result;
<i>272</i>&nbsp;        try {
<b class="fc"><i>273</i>&nbsp;            ParsePosition parsePosition = new ParsePosition(0);</b>
<b class="fc"><i>274</i>&nbsp;            result=  NumberFormat.getInstance(Locale.US).parse(value, parsePosition).doubleValue();</b>
<b class="fc"><i>275</i>&nbsp;            if (parsePosition.getIndex() != value.length()) {</b>
<b class="fc"><i>276</i>&nbsp;                throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be a valid double&quot;);</b>
<i>277</i>&nbsp;            }
<b class="fc"><i>278</i>&nbsp;        } catch (Exception ex) {</b>
<b class="fc"><i>279</i>&nbsp;            throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be a valid double&quot;, ex);</b>
<i>280</i>&nbsp;
<b class="fc"><i>281</i>&nbsp;        }</b>
<b class="fc"><i>282</i>&nbsp;        return result;</b>
<i>283</i>&nbsp;    }
<i>284</i>&nbsp;
<i>285</i>&nbsp;    /**
<i>286</i>&nbsp;     * Retrieves the date/time property from the given Properties instance.
<i>287</i>&nbsp;     * &lt;p&gt;
<i>288</i>&nbsp;     * Generic Parameters:
<i>289</i>&nbsp;     * T - the type of the exception to be thrown if some error occurred
<i>290</i>&nbsp;     * &lt;p&gt;
<i>291</i>&nbsp;     * Parameters:
<i>292</i>&nbsp;     * properties - the properties container
<i>293</i>&nbsp;     * key - the key of the property to be retrieved
<i>294</i>&nbsp;     * format - the expected date/time format string
<i>295</i>&nbsp;     * required - true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>296</i>&nbsp;     * exceptionClass - the type of the exception to be thrown if some error occurs
<i>297</i>&nbsp;     * &lt;p&gt;
<i>298</i>&nbsp;     * Returns:
<i>299</i>&nbsp;     * the retrieved date/time property value (null if property is optional and missing)
<i>300</i>&nbsp;     * &lt;p&gt;
<i>301</i>&nbsp;     * Throws:
<i>302</i>&nbsp;     * T if the property value has invalid format or is required, but missing
<i>303</i>&nbsp;     * &lt;p&gt;
<i>304</i>&nbsp;     * Implementation Notes:
<i>305</i>&nbsp;     * 1. String value = properties.getProperty(key);
<i>306</i>&nbsp;     * 2. If value == null then
<i>307</i>&nbsp;     * 2.1. If required then
<i>308</i>&nbsp;     * 2.1.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);
<i>309</i>&nbsp;     * 2.2. Return null.
<i>310</i>&nbsp;     * 3. parsePosition = new ParsePosition(0);
<i>311</i>&nbsp;     * 4. Date result = new SimpleDateFormat(format, Locale.US).parse(value, parsePosition);
<i>312</i>&nbsp;     * 5. If result == null or parsePosition.getIndex() != value.length() then
<i>313</i>&nbsp;     * 5.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be in format [&quot; + format + &quot;]&quot;);
<i>314</i>&nbsp;     * 6. Return result.
<i>315</i>&nbsp;     *
<i>316</i>&nbsp;     * @param format         the expected date/time format string
<i>317</i>&nbsp;     * @param exceptionClass the type of the exception to be thrown if some error occurs
<i>318</i>&nbsp;     * @param properties     the properties container
<i>319</i>&nbsp;     * @param key            the key of the property to be retrieved
<i>320</i>&nbsp;     * @param required       true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>321</i>&nbsp;     * @return the retrieved date/time property value (null if property is optional and missing)
<i>322</i>&nbsp;     * @throws T if the property value has invalid format or is required, but missing
<i>323</i>&nbsp;     */
<i>324</i>&nbsp;    public static &lt;T extends Throwable&gt; Date getDateProperty(Properties properties, String key, String format, boolean required, Class&lt;T&gt; exceptionClass) throws Exception, Throwable {
<b class="fc"><i>325</i>&nbsp;        String value = properties.getProperty(key);</b>
<b class="fc"><i>326</i>&nbsp;        if (value == null) {</b>
<b class="fc"><i>327</i>&nbsp;            if (required) {</b>
<b class="fc"><i>328</i>&nbsp;                throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);</b>
<i>329</i>&nbsp;            } else {
<b class="fc"><i>330</i>&nbsp;                return null;</b>
<i>331</i>&nbsp;            }
<i>332</i>&nbsp;        }
<b class="fc"><i>333</i>&nbsp;        ParsePosition parsePosition = new ParsePosition(0);</b>
<b class="fc"><i>334</i>&nbsp;        Date result = new SimpleDateFormat(format, Locale.US).parse(value, parsePosition);</b>
<b class="fc"><i>335</i>&nbsp;        if (result == null || parsePosition.getIndex() != value.length()) {</b>
<b class="fc"><i>336</i>&nbsp;            throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; should be in format [&quot; + format + &quot;]&quot;);</b>
<i>337</i>&nbsp;        }
<i>338</i>&nbsp;
<b class="fc"><i>339</i>&nbsp;        return result;</b>
<i>340</i>&nbsp;
<i>341</i>&nbsp;    }
<i>342</i>&nbsp;
<i>343</i>&nbsp;    /**
<i>344</i>&nbsp;     * Retrieves the class property from the given Properties instance. Property value is expected to contain a full class name.
<i>345</i>&nbsp;     * &lt;p&gt;
<i>346</i>&nbsp;     * Generic Parameters:
<i>347</i>&nbsp;     * T - the type of the exception to be thrown if some error occurred
<i>348</i>&nbsp;     * &lt;p&gt;
<i>349</i>&nbsp;     * Parameters:
<i>350</i>&nbsp;     * properties - the properties container
<i>351</i>&nbsp;     * key - the key of the property to be retrieved
<i>352</i>&nbsp;     * required - true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>353</i>&nbsp;     * exceptionClass - the type of the exception to be thrown if some error occurs
<i>354</i>&nbsp;     * &lt;p&gt;
<i>355</i>&nbsp;     * Returns:
<i>356</i>&nbsp;     * the retrieved class property value (null if property is optional and missing)
<i>357</i>&nbsp;     * &lt;p&gt;
<i>358</i>&nbsp;     * Throws:
<i>359</i>&nbsp;     * T if the property value has invalid format or is required, but missing
<i>360</i>&nbsp;     * &lt;p&gt;
<i>361</i>&nbsp;     * Implementation Notes:
<i>362</i>&nbsp;     * 1. String value = properties.getProperty(key);
<i>363</i>&nbsp;     * 2. If value == null then
<i>364</i>&nbsp;     * 2.1. If required then
<i>365</i>&nbsp;     * 2.1.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);
<i>366</i>&nbsp;     * 2.2. Return null.
<i>367</i>&nbsp;     * 3. Class&lt;?&gt; result = Class.forName(value);
<i>368</i>&nbsp;     * 4. If ex:Exception is thrown then
<i>369</i>&nbsp;     * 4.1. Throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; contains invalid full class name (&quot; + value + &quot;)&quot;, ex);
<i>370</i>&nbsp;     * 5. Return result.
<i>371</i>&nbsp;     *
<i>372</i>&nbsp;     * @param exceptionClass the type of the exception to be thrown if some error occurs
<i>373</i>&nbsp;     * @param properties     the properties container
<i>374</i>&nbsp;     * @param key            the key of the property to be retrieved
<i>375</i>&nbsp;     * @param required       true if property is required, false otherwise (if property is required, but missing, an exception is thrown)
<i>376</i>&nbsp;     * @return the retrieved class property value (null if property is optional and missing)
<i>377</i>&nbsp;     * @throws T if the property value has invalid format or is required, but missing
<i>378</i>&nbsp;     */
<i>379</i>&nbsp;    public static &lt;T extends Throwable&gt; Class&lt;?&gt; getClassProperty(Properties properties, String key, boolean required, Class&lt;T&gt; exceptionClass) throws Exception, Throwable {
<b class="fc"><i>380</i>&nbsp;        String value = properties.getProperty(key);</b>
<b class="fc"><i>381</i>&nbsp;        if (value == null) {</b>
<b class="fc"><i>382</i>&nbsp;            if (required) {</b>
<b class="fc"><i>383</i>&nbsp;                throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; is required&quot;);</b>
<i>384</i>&nbsp;            } else {
<b class="fc"><i>385</i>&nbsp;                return null;</b>
<i>386</i>&nbsp;            }
<i>387</i>&nbsp;        }
<i>388</i>&nbsp;        try {
<b class="fc"><i>389</i>&nbsp;            Class&lt;?&gt; result = Class.forName(value);</b>
<b class="fc"><i>390</i>&nbsp;            return result;</b>
<b class="fc"><i>391</i>&nbsp;        } catch (Exception ex) {</b>
<b class="fc"><i>392</i>&nbsp;            throw ExceptionHelper.constructException(exceptionClass, getPropertyTitle(key) + &quot; contains invalid full class name (&quot; + value + &quot;)&quot;, ex);</b>
<i>393</i>&nbsp;
<i>394</i>&nbsp;        }
<i>395</i>&nbsp;
<i>396</i>&nbsp;    }
<i>397</i>&nbsp;
<i>398</i>&nbsp;    /**
<i>399</i>&nbsp;     * Retrieves the inner configuration from the configuration stored in Properties container.
<i>400</i>&nbsp;     * &lt;p&gt;
<i>401</i>&nbsp;     * Parameters:
<i>402</i>&nbsp;     * properties - the properties with the main configuration
<i>403</i>&nbsp;     * configName - the name of the inner configuration
<i>404</i>&nbsp;     * &lt;p&gt;
<i>405</i>&nbsp;     * Returns:
<i>406</i>&nbsp;     * the Properties container with the extracted inner configuration (not null)
<i>407</i>&nbsp;     * &lt;p&gt;
<i>408</i>&nbsp;     * Implementation Notes:
<i>409</i>&nbsp;     * 1. String prefix = configName + &quot;.&quot;;
<i>410</i>&nbsp;     * 2. Create Properties instance for inner configuration:
<i>411</i>&nbsp;     * result = new Properties();
<i>412</i>&nbsp;     * 3. For each (String key; String value) from properties do:
<i>413</i>&nbsp;     * 3.1. If key.startsWith(prefix) then
<i>414</i>&nbsp;     * 3.1.1. Remove the prefix from the key:
<i>415</i>&nbsp;     * String newKey = key.substring(prefix.length());
<i>416</i>&nbsp;     * 3.1.2. Put key/value pair to the inner configuration:
<i>417</i>&nbsp;     * result.put(newKey, value);
<i>418</i>&nbsp;     * 4. Return result.
<i>419</i>&nbsp;     *
<i>420</i>&nbsp;     * @param configName the name of the inner configuration
<i>421</i>&nbsp;     * @param properties the properties with the main configuration
<i>422</i>&nbsp;     * @return the Properties container with the extracted inner configuration (not null)
<i>423</i>&nbsp;     */
<i>424</i>&nbsp;    public static Properties getSubConfiguration(Properties properties, String configName) {
<b class="fc"><i>425</i>&nbsp;        String prefix = configName + &quot;.&quot;;</b>
<b class="fc"><i>426</i>&nbsp;        Properties result = new Properties();</b>
<b class="fc"><i>427</i>&nbsp;        for (String key : properties.stringPropertyNames()</b>
<i>428</i>&nbsp;        ) {
<b class="fc"><i>429</i>&nbsp;            if (key.startsWith(prefix)) {</b>
<b class="fc"><i>430</i>&nbsp;                String newkey = key.substring(prefix.length());</b>
<b class="fc"><i>431</i>&nbsp;                result.put(newkey, properties.get(key));</b>
<i>432</i>&nbsp;            }
<b class="fc"><i>433</i>&nbsp;        }</b>
<b class="fc"><i>434</i>&nbsp;        return result;</b>
<i>435</i>&nbsp;    }
<i>436</i>&nbsp;
<i>437</i>&nbsp;    /**
<i>438</i>&nbsp;     * Retrieves the property title to be used in exception message.
<i>439</i>&nbsp;     * &lt;p&gt;
<i>440</i>&nbsp;     * Parameters:
<i>441</i>&nbsp;     * key - the property key
<i>442</i>&nbsp;     * &lt;p&gt;
<i>443</i>&nbsp;     * Returns:
<i>444</i>&nbsp;     * the constructed property title
<i>445</i>&nbsp;     * &lt;p&gt;
<i>446</i>&nbsp;     * Implementation Notes:
<i>447</i>&nbsp;     * 1. Return &quot;The property &#39;&quot; + key + &quot;&#39;&quot;.
<i>448</i>&nbsp;     *
<i>449</i>&nbsp;     * @param key the property key
<i>450</i>&nbsp;     * @return the constructed property title
<i>451</i>&nbsp;     */
<i>452</i>&nbsp;    private static String getPropertyTitle(String key) {
<i>453</i>&nbsp;
<b class="fc"><i>454</i>&nbsp;        return &quot;The property &#39;&quot; + key + &quot;&#39;&quot;;</b>
<i>455</i>&nbsp;    }
<i>456</i>&nbsp;}
<i>457</i>&nbsp;
</div>
</div>

<div class="footer">
    
    <div style="float:right;">generated on 2018-10-25 19:27</div>
</div>
</body>
</html>
